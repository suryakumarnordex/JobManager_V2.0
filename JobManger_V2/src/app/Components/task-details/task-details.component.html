<app-task-header></app-task-header>
<clr-datagrid
  class="datagrid-compact"
  [(clrDgSelected)]="selected"
  [clrDgLoading]="this.dataloading"
  style="height: 500px"
  HorizontalAlignment="auto"
  VerticalAlignment="auto"
  (clrDgSelectedChange)="selectionChanged($event)"
>
  <clr-dg-column>Task ID</clr-dg-column>
  <clr-dg-column>Task Name</clr-dg-column>
  <clr-dg-column>Task State</clr-dg-column>
  <clr-dg-column>Exit Code</clr-dg-column>
  <clr-dg-column>Log</clr-dg-column>
  <clr-dg-column>Start Time (yy/mm/dd HH:mm)</clr-dg-column>
  <clr-dg-column>End Time (yy/mm/dd HH:mm)</clr-dg-column>
  <clr-dg-column>Allocated Nodes</clr-dg-column>
  <clr-dg-column>Command Line</clr-dg-column>

  <clr-dg-row *ngFor="let task of taskLayout" [clrDgItem]="task">
    <clr-dg-cell
      ><div class="hidden">
        <span title="{{ task.taskIdFragment }}"
          >{{ task.taskIdFragment }}
        </span>
      </div></clr-dg-cell
    >
    <clr-dg-cell
      ><div class="hidden">
        <span title="{{ task.nameFragment }}">{{ task.nameFragment }} </span>
      </div></clr-dg-cell
    >
    <clr-dg-cell
      [style.color]="
        task.statusFragment == 'Failed'
          ? 'red'
          : task.statusFragment == 'Running'
          ? 'blue'
          : task.statusFragment == 'Finished'
          ? 'green'
          : task.statusFragment == 'Canceled'
          ? 'orange'
          : task.statusFragment == 'Queued'
          ? 'Magenta'
          : 'black'
      "
      [style.width.px]="200"
      style="text-align: left"
    >
      <div class="hidden">
        <span title="{{ task.statusFragment }}"
          >{{ task.statusFragment }}
        </span>
      </div></clr-dg-cell
    >
    <clr-dg-cell>
      <div
        role="tooltip"
        aria-haspopup="true"
        class="tooltip tooltip-lg tooltip-bottom-left"
      >
        {{ task.exidCodeFragment }}
        <span class="tooltip-content" style="width: auto">{{
          task.exidCodeNameFragment
        }}</span>
      </div>
    </clr-dg-cell>

    <!-- <clr-dg-cell>
      <button
        class="btn btn-outline btn-sm"
        (click)="showFileData(task.standardOutput)"
      >
        Link To Standard Output
      </button>
    </clr-dg-cell> -->

    <clr-dg-cell style="text-align: left">
      <div style="display: flex; justify-content: space-evenly">
        <div>
          <div
            role="tooltip"
            aria-haspopup="true"
            class="tooltip tooltip-sm tooltip tooltip-right"
            style="text-align: center"
          >
            Link To Standard Output
            <span class="tooltip-content">{{ task.standardOutput }} </span>
          </div>
        </div>
        <div>
          <div (click)="showFileData(task.standardOutput)">
            <a
              href="javascript:void(0)"
              role="tooltip"
              aria-haspopup="true"
              class="tooltip tooltip-sm tooltip tooltip-right"
            >
              <clr-icon
                shape="copy-to-clipboard"
                class="is-solid has-badge-info"
                *ngIf="task.standardOutput != undefined"
              ></clr-icon>
              <span class="tooltip-content">{{ task.standardOutput }}</span>
            </a>
          </div>
        </div>
      </div>
    </clr-dg-cell>

    <clr-dg-cell
      ><div class="hidden">
        <span title="{{ task.startTimeFragment | utcToLocalTime : 'short' }}"
          >{{ task.startTimeFragment | utcToLocalTime : "short" }}
        </span>
      </div></clr-dg-cell
    >
    <clr-dg-cell
      ><div class="hidden">
        <span title="{{ task.endTimeFragment | utcToLocalTime : 'short' }}"
          >{{ task.endTimeFragment | utcToLocalTime : "short" }}
        </span>
      </div></clr-dg-cell
    >
    <clr-dg-cell
      ><div class="hidden">
        <span title="{{ task.allocatedNodesFragment }}"
          >{{ task.allocatedNodesFragment }}
        </span>
      </div></clr-dg-cell
    >
    <clr-dg-cell
      ><div class="hidden">
        <span title="{{ task.commandLineFragment }}"
          >{{ task.commandLineFragment }}
        </span>
      </div></clr-dg-cell
    >
  </clr-dg-row>
  <clr-dg-footer>
    <app-job-footer
      [requestFromJob]="false"
      [totalRecordstask]="totalRecords"
      [recordPerPagerequesttask]="recordPerPage"
      [currentPagetask]="pageSize"
      [totalPagetask]="totalPage"
    ></app-job-footer>
  </clr-dg-footer>
</clr-datagrid>
<clr-modal
  [(clrModalOpen)]="this.TaskDetailsLocalVariable.openModal"
  [clrModalSize]="'lg'"
  [clrModalSkipAnimation]="'true'"
>
  <div
    class="modal-body"
    *ngFor="let item of this.TaskDetailsLocalVariable.LogFileData"
  >
    <ul style="list-style-type: none">
      <li>{{ item }}</li>
    </ul>
  </div>
</clr-modal>
